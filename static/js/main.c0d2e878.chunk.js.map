{"version":3,"sources":["components/Helpers.js","pages/Send.js","pages/Receive.js","App.js","index.js","images/logo.png"],"names":["fromNear","s","parseFloat","loader","className","key","role","SendPage","props","profileId","signedAccountId","useState","showButtons","setShowButtons","e","output","a","preventDefault","console","log","_near","contract","stop_stream","stream_id","res","ownerId","document","getElementById","value","receiverId","deposit","String","parseInt","speed","create_stream","owner_id","receiver_id","token_name","tokens_per_tick","fetchAccount","get_account","account_id","account","useSWR","errorRetryInterval","data","outputs","connected","map","id","style","width","margin","substr","balance","toFixed","tokens_available","tokens_transferred","status","disabled","signedIn","onClick","stopStreamClick","onSubmit","createStreamClick","htmlFor","placeholder","describedby","ReceivePage","input","withdraw","inputs","withdrawStreamClick","NearConfig","window","location","hostname","accountSuffix","networkId","nodeUrl","contractName","walletUrl","App","state","config","_initNear","then","setState","accountId","keyStore","nearAPI","BrowserLocalStorageKeyStore","Object","assign","deps","near","this","walletConnection","getAccountId","viewMethods","changeMethods","logOut","signOut","_accountId","refreshAllowance","alert","requestSignIn","passProps","header","aria-hidden","backgroundColor","basename","process","to","title","src","Logo","alt","opacity","type","data-bs-toggle","data-bs-target","aria-controls","aria-expanded","aria-label","aria-current","exact","path","Send","Receive","React","Component","ReactDOM","render","module","exports"],"mappings":"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","file":"static/js/main.c0d2e878.chunk.js","sourcesContent":["import React from 'react'\n\nconst NEAR = '\\u24C3\\u202F'\n\nconst fromNear = (s) => parseFloat(s) / 1e24 || 0\n\nfunction loader () {\n  return (\n  // key='1' is needed by InfiniteScroll\n    <div className='d-flex justify-content-center' key='1'>\n      <div className='spinner-grow' role='status'>\n        <span className='visually-hidden'>Loading...</span>\n      </div>\n    </div>\n  )\n}\n\nexport { NEAR, fromNear, loader }\n","import React, { useState } from 'react'\nimport useSWR from 'swr'\n\nimport { NEAR, fromNear, loader } from '../components/Helpers'\n\nfunction SendPage (props) {\n  const profileId = props.signedAccountId\n  const [showButtons, setShowButtons] = useState(true)\n\n  async function stopStreamClick (e, output) {\n    e.preventDefault()\n    setShowButtons(false)\n    console.log('stopping', output)\n    const res = await props._near.contract.stop_stream({ stream_id: output.stream_id }, '200000000000000', 1)\n    console.log('stopping res', res)\n  }\n\n  async function createStreamClick (e) {\n    e.preventDefault()\n    setShowButtons(false)\n    const ownerId = document.getElementById('ownerInput').value\n    const receiverId = document.getElementById('receiverInput').value\n    // TODO\n    const deposit = String(parseInt((parseFloat(document.getElementById('depositInput').value) + 1e-1) * 1e9)) + '000000000000000'\n    const speed = String(parseInt((parseFloat(document.getElementById('speedInput').value) + 0) * 1e9)) + '000000'\n    const res = await props._near.contract.create_stream({ owner_id: ownerId, receiver_id: receiverId, token_name: 'NEAR', tokens_per_tick: speed }, '200000000000000', deposit)\n    console.log('create res', res)\n  }\n\n  const fetchAccount = async (...args) => {\n    try {\n      if (!profileId) {\n        return []\n      }\n      return await props._near.contract.get_account({ account_id: profileId })\n    } catch (e) {\n      console.log('near error', e)\n    }\n    return []\n  }\n\n  const { data: account } = useSWR(['account', profileId], fetchAccount, { errorRetryInterval: 250 })\n  let outputs = (account && account.outputs) ? account.outputs : []\n\n  if (props.connected && account) {\n    console.log('account', account)\n    outputs = outputs.map((output, id) => {\n      return (\n        <div className='card' style={{ width: '90%', margin: '15px' }} key={id}>\n          <div className='card-body'>\n            <div className='d-flex flex-row justify-content-between w-100'>\n              <div className='col-2 m-1'>\n                {output.receiver_id}\n              </div>\n              <small className='col-1 m-1'>\n                <small><samp className='text-secondary'>{output.stream_id.substr(0, 6)}...</samp></small>\n              </small>\n              <small className='col-1 m-1'>\n                {fromNear(output.balance).toFixed(2)}\n              </small>\n              <small className='col-1 m-1'>\n                {output.token_name}\n              </small>\n              <small className='col-1 m-1'>\n                {(fromNear(output.tokens_per_tick) * 1e9).toFixed(2)} {output.token_name}/s\n              </small>\n              <small className='col-1 m-1'>\n                {fromNear(output.tokens_available).toFixed(2)}\n              </small>\n              <small className='col-1 m-1'>\n                {fromNear(output.tokens_transferred).toFixed(2)}\n              </small>\n              <small className='col-1 m-1'>\n                {output.status}\n              </small>\n              <div className='col-2 m-1'>\n                {props.connected && showButtons && output.status === 'ACTIVE' ? (\n                  <button disabled={!props.signedIn} className='btn btn-danger' onClick={(e) => stopStreamClick(e, output)}>Stop the stream</button>\n                ) : (\n                  <div className='mt-4'>{loader()}</div>)}\n              </div>\n            </div>\n          </div>\n        </div>\n      )\n    })\n  }\n\n  console.log(props)\n\n  return (!props.connected) ? (<div className='container g-0 px-5'>Please connect your NEAR Account first</div>) : (\n    <div className='container g-0 px-5'>\n      <div className='card' style={{ width: '90%', margin: '15px' }}>\n        <div className='card-body'>\n          <h5 className='card-title'>Create a stream</h5>\n          <h6 className='card-subtitle mb-3 text-muted'>Stream your tokens to the receiver directly</h6>\n          <form onSubmit={(e) => createStreamClick(e)}>\n            <div className='form-group mb-2'>\n              <label htmlFor='ownerInput' className='mb-2'>Owner</label>\n              <input className='form-control' id='ownerInput' placeholder={props.signedAccountId} />\n            </div>\n            <div className='form-group mb-2'>\n              <label htmlFor='receiverInput' className='mb-2'>Receiver</label>\n              <input className='form-control' id='receiverInput' placeholder='root.near' />\n            </div>\n            <label htmlFor='depositInput' className='mb-2'>Initial deposit</label>\n            <div className='input-group mb-2'>\n              <div className='input-group-prepend'>\n                <span className='input-group-text' id='basic-addon1'>{NEAR}</span>\n              </div>\n              <input className='form-control' id='depositInput' placeholder='15.70' describedby='basic-addon1' />\n            </div>\n            <label htmlFor='speedInput' className='mb-2'>Streaming speed, tokens per second</label>\n            <div className='input-group mb-2'>\n              <div className='input-group-prepend'>\n                <span className='input-group-text' id='basic-addon2'>{NEAR}</span>\n              </div>\n              <input className='form-control' id='speedInput' placeholder='0.03' describedby='basic-addon2' />\n            </div>\n\n            {props.connected && showButtons ? (\n              <button disabled={!props.signedIn} className='btn btn-primary mt-4'>Create a stream</button>\n            ) : (\n              <div className='mt-4'>{loader()}</div>)}\n          </form>\n        </div>\n      </div>\n      <h4>Streams owned by you</h4>\n      <div className='card' style={{ width: '90%', margin: '15px' }}>\n        <div className='card-body'>\n          <div className='d-flex flex-row justify-content-between w-100'>\n            <div className='col-2 m-1'>\n            Receiver\n            </div>\n            <div className='col-1 m-1'>\n            Stream ID\n            </div>\n            <div className='col-1 m-1'>\n            Total amount\n            </div>\n            <div className='col-1 m-1'>\n            Token name\n            </div>\n            <div className='col-1 m-1'>\n            Stream speed\n            </div>\n            <div className='col-1 m-1'>\n            Tokens unlocked\n            </div>\n            <div className='col-1 m-1'>\n            Tokens transferred\n            </div>\n            <div className='col-1 m-1'>\n            Stream status\n            </div>\n            <div className='col-2 m-1' />\n          </div>\n        </div>\n      </div>\n      {outputs}\n    </div>\n  )\n}\n\nexport default SendPage\n","import React, { useState } from 'react'\nimport useSWR from 'swr'\n\nimport { fromNear, loader } from '../components/Helpers'\n\nfunction ReceivePage (props) {\n  const profileId = props.signedAccountId\n  const [showButtons, setShowButtons] = useState(true)\n\n  async function withdrawStreamClick (e, input) {\n    e.preventDefault()\n    setShowButtons(false)\n    console.log('withdraw', input)\n    const res = await props._near.contract.withdraw({ stream_id: input.stream_id }, '200000000000000', 0)\n    console.log('withdraw res', res)\n    // TODO update the page instantly\n    setShowButtons(true)\n  }\n\n  async function stopStreamClick (e, input) {\n    e.preventDefault()\n    setShowButtons(false)\n    console.log('stopping', input)\n    const res = await props._near.contract.stop_stream({ stream_id: input.stream_id }, '200000000000000', 1)\n    console.log('stopping res', res)\n  }\n\n  const fetchAccount = async (...args) => {\n    try {\n      if (!profileId) {\n        return []\n      }\n      return await props._near.contract.get_account({ account_id: profileId })\n    } catch (e) {\n      console.log('near error', e)\n    }\n    return []\n  }\n\n  const { data: account } = useSWR(['account', profileId], fetchAccount, { errorRetryInterval: 250 })\n  let inputs = (account && account.inputs) ? account.inputs : []\n\n  if (props.connected && account) {\n    console.log('account', account)\n    inputs = inputs.map((input, id) => {\n      return (\n        <div className='card' style={{ width: '90%', margin: '15px' }} key={id}>\n          <div className='card-body'>\n            <div className='d-flex flex-row justify-content-between w-100'>\n              <div className='col-2 m-1'>\n                {input.owner_id}\n              </div>\n              <small className='col-1 m-1'>\n                <small><samp className='text-secondary'>{input.stream_id.substr(0, 6)}...</samp></small>\n              </small>\n              <small className='col-1 m-1'>\n                {fromNear(input.balance).toFixed(2)}\n              </small>\n              <small className='col-1 m-1'>\n                {input.token_name}\n              </small>\n              <small className='col-1 m-1'>\n                {(fromNear(input.tokens_per_tick) * 1e9).toFixed(2)} {input.token_name}/s\n              </small>\n              <small className='col-1 m-1'>\n                {fromNear(input.tokens_available).toFixed(2)}\n              </small>\n              <small className='col-1 m-1'>\n                {fromNear(input.tokens_transferred).toFixed(2)}\n              </small>\n              <small className='col-1 m-1'>\n                {input.status}\n              </small>\n              <div className='col-2 m-1'>\n                {props.connected && showButtons && input.status === 'ACTIVE' ? (\n                  <div className='d-flex flex-row'>\n                    <button disabled={!props.signedIn} className='btn btn-success btn-sm m-1' onClick={(e) => withdrawStreamClick(e, input)}>Withdraw</button>\n                    <button disabled={!props.signedIn} className='btn btn-danger btn-sm m-1' onClick={(e) => stopStreamClick(e, input)}>Stop</button>\n                  </div>\n                ) : (\n                  <div className='mt-4'>{loader()}</div>)}\n              </div>\n            </div>\n          </div>\n        </div>\n      )\n    })\n  }\n\n  console.log(props)\n\n  return (!props.connected) ? (<div className='container g-0 px-5'>Please connect your NEAR Account first</div>) : (\n    <div className='container g-0 px-5'>\n      <h4>Your receiving streams</h4>\n      <div className='card' style={{ width: '90%', margin: '15px' }}>\n        <div className='card-body'>\n          <div className='d-flex flex-row justify-content-between w-100'>\n            <div className='col-2 m-1'>\n            From owner\n            </div>\n            <div className='col-1 m-1'>\n            Stream ID\n            </div>\n            <div className='col-1 m-1'>\n            Tokens left\n            </div>\n            <div className='col-1 m-1'>\n            Token name\n            </div>\n            <div className='col-1 m-1'>\n            Stream speed\n            </div>\n            <div className='col-1 m-1'>\n            Tokens unlocked\n            </div>\n            <div className='col-1 m-1'>\n            Tokens transferred\n            </div>\n            <div className='col-1 m-1'>\n            Stream status\n            </div>\n            <div className='col-2 m-1' />\n          </div>\n        </div>\n      </div>\n      {inputs}\n    </div>\n  )\n}\n\nexport default ReceivePage\n","import React from 'react'\nimport 'error-polyfill'\nimport 'bootstrap/dist/js/bootstrap.bundle'\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport './App.scss'\nimport * as nearAPI from 'near-api-js'\nimport Logo from './images/logo.png'\nimport { HashRouter as Router, Link, Route, Switch } from 'react-router-dom'\nimport SendPage from './pages/Send'\nimport ReceivePage from './pages/Receive'\n\nconst IsMainnet = window.location.hostname === '(xyiming)' // TODO\nconst TestNearConfig = {\n  accountSuffix: 'testnet',\n  networkId: 'testnet',\n  nodeUrl: 'https://rpc.testnet.near.org',\n  contractName: 'dev-1630411495814-97749356114440',\n  walletUrl: 'https://wallet.testnet.near.org'\n}\nconst MainNearConfig = {\n  accountSuffix: 'near',\n  networkId: 'mainnet',\n  nodeUrl: 'https://rpc.mainnet.near.org',\n  contractName: 'dev-1630411495814-97749356114440',\n  walletUrl: 'https://wallet.near.org'\n}\n\nconst NearConfig = IsMainnet ? MainNearConfig : TestNearConfig\n\nclass App extends React.Component {\n  constructor (props) {\n    super(props)\n\n    this._near = {}\n\n    this.state = {\n      connected: false,\n      account: null\n    }\n\n    this._near.config = NearConfig\n\n    this._initNear().then(() => {\n      this.setState({\n        signedIn: !!this._near.accountId,\n        signedAccountId: this._near.accountId,\n        connected: true\n      })\n    })\n  }\n\n  async _initNear () {\n    const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore()\n    const near = await nearAPI.connect(Object.assign({ deps: { keyStore } }, NearConfig))\n    this._near.keyStore = keyStore\n    this._near.near = near\n\n    this._near.walletConnection = new nearAPI.WalletConnection(near, NearConfig.contractName)\n    this._near.accountId = this._near.walletConnection.getAccountId()\n\n    this._near.account = this._near.walletConnection.account()\n    this._near.contract = new nearAPI.Contract(this._near.account, NearConfig.contractName, {\n      viewMethods: [\n        'get_account',\n        'get_stream'\n      ],\n      changeMethods: [\n        'create_stream',\n        'deposit',\n        'withdraw',\n        'stop_stream'\n      ]\n    })\n\n    this._near.logOut = () => {\n      this._near.walletConnection.signOut()\n      this._near.accountId = null\n      this.setState({\n        signedIn: !!this._accountId,\n        signedAccountId: this._accountId\n      })\n    }\n\n    this._near.refreshAllowance = async () => {\n      alert(\"You're out of access key allowance. Need sign in again to refresh it\")\n      await this.logOut()\n      await this.requestSignIn()\n    }\n  }\n\n  async requestSignIn (e) {\n    e && e.preventDefault()\n    const appTitle = 'Streaming Xyiming'\n    await this._near.walletConnection.requestSignIn(\n      NearConfig.contractName,\n      appTitle\n    )\n    return false\n  }\n\n  render () {\n    const passProps = {\n      _near: this._near,\n      refreshAllowance: () => this._near.refreshAllowance(),\n      ...this.state\n    }\n    const header = !this.state.connected ? (\n      <div>Connecting... <span className='spinner-grow spinner-grow-sm' role='status' aria-hidden='true' /></div>\n    ) : (this.state.signedIn ? (\n      <div>\n        <button\n          className='btn btn-outline-secondary'\n          onClick={() => this._near.logOut()}\n        >Sign out ({this.state.signedAccountId})\n        </button>\n      </div>\n    ) : (\n      <div>\n        <button\n          className='btn btn-primary'\n          onClick={(e) => this.requestSignIn(e)}\n        >Sign in with NEAR Wallet\n        </button>\n      </div>\n    ))\n\n    return (\n      <div className='App text-white' style={{ backgroundColor: '#1E1E1E' }}>\n        <Router basename={process.env.PUBLIC_URL}>\n          <nav className='navbar navbar-expand-lg navbar-dark mb-3' style={{ backgroundColor: '#2F2F2F' }}>\n            <div className='container-fluid'>\n              <Link className='navbar-brand' to='/' title='Xyiming'>\n                <img src={Logo} alt='Xyiming' className='d-inline-block align-middle' style={{ opacity: 0.9, backgroundColor: 'lightblue' }} />\n                Streaming Xyiming\n              </Link>\n              <button\n                className='navbar-toggler' type='button' data-bs-toggle='collapse'\n                data-bs-target='#navbarSupportedContent' aria-controls='navbarSupportedContent'\n                aria-expanded='false' aria-label='Toggle navigation'\n              >\n                <span className='navbar-toggler-icon' />\n              </button>\n              <div className='collapse navbar-collapse' id='navbarSupportedContent'>\n                <ul className='navbar-nav me-auto mb-2 mb-lg-0'>\n                  <li className='nav-item'>\n                    <Link className='nav-link' aria-current='page' to='/'>Send</Link>\n                  </li>\n                  <li className='nav-item'>\n                    <Link className='nav-link' aria-current='page' to='/receive'>Receive</Link>\n                  </li>\n                </ul>\n                <form className='d-flex'>\n                  {header}\n                </form>\n              </div>\n            </div>\n          </nav>\n\n          <Switch>\n            <Route exact path='/'>\n              <SendPage {...passProps} />\n            </Route>\n            <Route exact path='/receive'>\n              <ReceivePage {...passProps} />\n            </Route>\n          </Switch>\n        </Router>\n      </div>\n    )\n  }\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n","module.exports = __webpack_public_path__ + \"static/media/logo.e9cb853c.png\";"],"sourceRoot":""}
(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{131:function(e,t,n){},134:function(e,t){},140:function(e,t){},156:function(e,t){},158:function(e,t){},176:function(e,t){},187:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),s=n(93),r=n.n(s),l=n(42),o=n(2),i=n.n(o),d=n(10),u=n(94),m=n(95),b=n(99),j=n(98),p=(n(60),n(120),n(130),n(131),n(31)),h=n.p+"static/media/logo.fd13f323.png",x=n(32),O=n(4),v=n(41),g=n(40),f=n(0),N=function(e){return parseFloat(e)/1e24||0};var w=function(e){var t=e.signedAccountId,n=Object(c.useState)(!0),a=Object(v.a)(n,2),s=a[0],r=a[1];function l(){return(l=Object(d.a)(i.a.mark((function t(n,c){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r(!1),console.log("pausing",c),t.next=5,e._near.contract.pause_stream({stream_id:c.stream_id},"200000000000000",1);case 5:a=t.sent,console.log("pausing res",a);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function o(){return(o=Object(d.a)(i.a.mark((function t(n,c){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r(!1),console.log("restarting",c),t.next=5,e._near.contract.restart_stream({stream_id:c.stream_id},"200000000000000",1);case 5:a=t.sent,console.log("restarting res",a);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function u(){return(u=Object(d.a)(i.a.mark((function t(n,c){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r(!1),console.log("stopping",c),t.next=5,e._near.contract.stop_stream({stream_id:c.stream_id},"200000000000000",1);case 5:a=t.sent,console.log("stopping res",a);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function m(){return(m=Object(d.a)(i.a.mark((function t(n){var c,a,s,l,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r(!1),c=document.getElementById("ownerInput").value,a=document.getElementById("receiverInput").value,s=String(parseInt(1e9*(parseFloat(document.getElementById("depositInput").value)+.1)))+"000000000000000",l=String(parseInt(1e9*(parseFloat(document.getElementById("speedInput").value)+0)))+"000000",t.next=8,e._near.contract.create_stream({description:"blabla",owner_id:c,receiver_id:a,token_name:"NEAR",tokens_per_tick:l},"200000000000000",s);case 8:o=t.sent,console.log("create res",o);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var b=function(){var n=Object(d.a)(i.a.mark((function n(){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,t){n.next=3;break}return n.abrupt("return",[]);case 3:return n.next=5,e._near.contract.get_account({account_id:t});case 5:return n.abrupt("return",n.sent);case 8:n.prev=8,n.t0=n.catch(0),console.log("near error",n.t0);case 11:return n.abrupt("return",[]);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}(),j=Object(g.a)(["account",t],b,{errorRetryInterval:250}).data,p=j&&j.outputs?j.outputs:[];return e.connected&&j&&(console.log("account",j),p=p.map((function(t,n){return Object(f.jsx)("div",{className:"card",style:{width:"90%",margin:"15px",backgroundColor:"#141414"},children:Object(f.jsx)("div",{className:"card-body",children:Object(f.jsxs)("div",{className:"d-flex flex-row justify-content-between w-100",children:[Object(f.jsx)("div",{className:"col-2 m-1",children:t.receiver_id}),Object(f.jsx)("small",{className:"col-1 m-1",children:Object(f.jsx)("small",{children:Object(f.jsxs)("samp",{className:"text-secondary",children:[t.stream_id.substr(0,6),"..."]})})}),Object(f.jsx)("small",{className:"col-1 m-1",children:N(t.balance).toFixed(2)}),Object(f.jsx)("small",{className:"col-1 m-1",children:t.token_name}),Object(f.jsxs)("small",{className:"col-1 m-1",children:[(1e9*N(t.tokens_per_tick)).toFixed(2)," ",t.token_name,"/s"]}),Object(f.jsx)("small",{className:"col-1 m-1",children:N(t.tokens_available).toFixed(2)}),Object(f.jsx)("small",{className:"col-1 m-1",children:N(t.tokens_transferred).toFixed(2)}),Object(f.jsx)("small",{className:"col-1 m-1",children:t.status}),Object(f.jsx)("div",{className:"col-2 m-1",children:e.connected&&s&&("ACTIVE"===t.status||"PAUSED"===t.status)?Object(f.jsxs)("div",{className:"d-flex flex-row",children:[Object(f.jsx)("div",{children:"ACTIVE"===t.status?Object(f.jsx)("button",{disabled:!e.signedIn,className:"btn btn-warning btn-sm m-1",onClick:function(e){return function(e,t){return l.apply(this,arguments)}(e,t)},children:"Pause"}):Object(f.jsx)("button",{disabled:!e.signedIn,className:"btn btn-warning btn-sm m-1",onClick:function(e){return function(e,t){return o.apply(this,arguments)}(e,t)},children:"Restart"})}),Object(f.jsx)("button",{disabled:!e.signedIn,className:"btn btn-danger btn-sm m-1",onClick:function(e){return function(e,t){return u.apply(this,arguments)}(e,t)},children:"Stop"})]}):Object(f.jsx)("div",{})})]})})},n)}))),console.log(e),e.connected?Object(f.jsxs)("div",{className:"container g-0 px-5",children:[Object(f.jsx)("div",{className:"card",style:{width:"90%",margin:"15px",backgroundColor:"#141414"},children:Object(f.jsxs)("div",{className:"card-body",children:[Object(f.jsx)("h5",{className:"card-title",children:"Create a stream"}),Object(f.jsx)("h6",{className:"card-subtitle mb-3 text-muted",children:"Stream your tokens to the receiver directly"}),Object(f.jsxs)("form",{onSubmit:function(e){return function(e){return m.apply(this,arguments)}(e)},children:[Object(f.jsxs)("div",{className:"form-group mb-2",children:[Object(f.jsx)("label",{htmlFor:"ownerInput",className:"mb-2",children:"Owner"}),Object(f.jsx)("input",{className:"form-control",id:"ownerInput",placeholder:e.signedAccountId,style:{backgroundColor:"#101010",color:"#e0e0e0"}})]}),Object(f.jsxs)("div",{className:"form-group mb-2",children:[Object(f.jsx)("label",{htmlFor:"receiverInput",className:"mb-2",children:"Receiver"}),Object(f.jsx)("input",{className:"form-control",id:"receiverInput",placeholder:"root.near",style:{backgroundColor:"#101010",color:"#e0e0e0"}})]}),Object(f.jsx)("label",{htmlFor:"depositInput",className:"mb-2",children:"Initial deposit"}),Object(f.jsxs)("div",{className:"input-group mb-2",children:[Object(f.jsx)("div",{className:"input-group-prepend",children:Object(f.jsx)("span",{className:"input-group-text",id:"basic-addon1",style:{backgroundColor:"#303030",color:"#e0e0e0"},children:"\u24c3\u202f"})}),Object(f.jsx)("input",{className:"form-control",id:"depositInput",placeholder:"15.70",describedby:"basic-addon1",style:{backgroundColor:"#101010",color:"#e0e0e0"}})]}),Object(f.jsx)("label",{htmlFor:"speedInput",className:"mb-2",children:"Streaming speed, tokens per second"}),Object(f.jsxs)("div",{className:"input-group mb-2",children:[Object(f.jsx)("div",{className:"input-group-prepend",children:Object(f.jsx)("span",{className:"input-group-text",id:"basic-addon2",style:{backgroundColor:"#303030",color:"#e0e0e0"},children:"\u24c3\u202f"})}),Object(f.jsx)("input",{className:"form-control",id:"speedInput",placeholder:"0.03",describedby:"basic-addon2",style:{backgroundColor:"#101010",color:"#e0e0e0"}})]}),e.connected&&s?Object(f.jsx)("button",{disabled:!e.signedIn,className:"btn btn-primary mt-4",children:"Create a stream"}):Object(f.jsx)("div",{className:"mt-4",children:Object(f.jsx)("div",{className:"d-flex justify-content-center",children:Object(f.jsx)("div",{className:"spinner-grow",role:"status",children:Object(f.jsx)("span",{className:"visually-hidden",children:"Loading..."})})},"1")})]})]})}),Object(f.jsx)("h4",{children:"Streams owned by you"}),Object(f.jsx)("div",{className:"card",style:{width:"90%",margin:"15px",backgroundColor:"#181818"},children:Object(f.jsx)("div",{className:"card-body",children:Object(f.jsxs)("div",{className:"d-flex flex-row justify-content-between w-100",children:[Object(f.jsx)("div",{className:"col-2 m-1",children:"Receiver"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Stream ID"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Tokens left"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Token name"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Stream speed"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Tokens unlocked"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Tokens transferred"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Stream status"}),Object(f.jsx)("div",{className:"col-2 m-1"})]})})}),p]}):Object(f.jsx)("div",{className:"container g-0 px-5",children:"Please connect your NEAR Account first"})};var _=function(e){var t=e.signedAccountId,n=Object(c.useState)(!0),a=Object(v.a)(n,2),s=a[0],r=a[1];function l(){return(l=Object(d.a)(i.a.mark((function t(n,c){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r(!1),console.log("pausing",c),t.next=5,e._near.contract.pause_stream({stream_id:c.stream_id},"200000000000000",1);case 5:a=t.sent,console.log("pausing res",a);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function o(){return(o=Object(d.a)(i.a.mark((function t(n,c){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r(!1),console.log("withdraw",c),t.next=5,e._near.contract.withdraw({stream_id:c.stream_id},"200000000000000",0);case 5:a=t.sent,console.log("withdraw res",a),r(!0);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function u(){return(u=Object(d.a)(i.a.mark((function t(n,c){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r(!1),console.log("stopping",c),t.next=5,e._near.contract.stop_stream({stream_id:c.stream_id},"200000000000000",1);case 5:a=t.sent,console.log("stopping res",a);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var m=function(){var n=Object(d.a)(i.a.mark((function n(){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,t){n.next=3;break}return n.abrupt("return",[]);case 3:return n.next=5,e._near.contract.get_account({account_id:t});case 5:return n.abrupt("return",n.sent);case 8:n.prev=8,n.t0=n.catch(0),console.log("near error",n.t0);case 11:return n.abrupt("return",[]);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}(),b=Object(g.a)(["account",t],m,{errorRetryInterval:250}).data,j=b&&b.inputs?b.inputs:[];return e.connected&&b&&(console.log("account",b),j=j.map((function(t,n){return Object(f.jsx)("div",{className:"card",style:{width:"90%",margin:"15px",backgroundColor:"#141414"},children:Object(f.jsx)("div",{className:"card-body",children:Object(f.jsxs)("div",{className:"d-flex flex-row justify-content-between w-100",children:[Object(f.jsx)("div",{className:"col-2 m-1",children:t.owner_id}),Object(f.jsx)("small",{className:"col-1 m-1",children:Object(f.jsx)("small",{children:Object(f.jsxs)("samp",{className:"text-secondary",children:[t.stream_id.substr(0,6),"..."]})})}),Object(f.jsx)("small",{className:"col-1 m-1",children:N(t.balance).toFixed(2)}),Object(f.jsx)("small",{className:"col-1 m-1",children:t.token_name}),Object(f.jsxs)("small",{className:"col-1 m-1",children:[(1e9*N(t.tokens_per_tick)).toFixed(2)," ",t.token_name,"/s"]}),Object(f.jsx)("small",{className:"col-1 m-1",children:N(t.tokens_available).toFixed(2)}),Object(f.jsx)("small",{className:"col-1 m-1",children:N(t.tokens_transferred).toFixed(2)}),Object(f.jsx)("small",{className:"col-1 m-1",children:t.status}),Object(f.jsx)("div",{className:"col-2 m-1",children:e.connected&&s&&"ACTIVE"===t.status?Object(f.jsxs)("div",{className:"d-flex flex-row",children:[Object(f.jsx)("button",{disabled:!e.signedIn,className:"btn btn-success btn-sm m-1",onClick:function(e){return function(e,t){return o.apply(this,arguments)}(e,t)},children:"Withdraw"}),Object(f.jsx)("button",{disabled:!e.signedIn,className:"btn btn-warning btn-sm m-1",onClick:function(e){return function(e,t){return l.apply(this,arguments)}(e,t)},children:"Pause"}),Object(f.jsx)("button",{disabled:!e.signedIn,className:"btn btn-danger btn-sm m-1",onClick:function(e){return function(e,t){return u.apply(this,arguments)}(e,t)},children:"Stop"})]}):Object(f.jsx)("div",{})})]})})},n)}))),console.log(e),e.connected?Object(f.jsxs)("div",{className:"container g-0 px-5",children:[Object(f.jsx)("h4",{children:"Your receiving streams"}),Object(f.jsx)("div",{className:"card",style:{width:"90%",margin:"15px",backgroundColor:"#181818"},children:Object(f.jsx)("div",{className:"card-body",children:Object(f.jsxs)("div",{className:"d-flex flex-row justify-content-between w-100",children:[Object(f.jsx)("div",{className:"col-2 m-1",children:"From owner"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Stream ID"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Tokens left"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Token name"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Stream speed"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Tokens unlocked"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Tokens transferred"}),Object(f.jsx)("div",{className:"col-1 m-1",children:"Stream status"}),Object(f.jsx)("div",{className:"col-2 m-1"})]})})}),j]}):Object(f.jsx)("div",{className:"container g-0 px-5",children:"Please connect your NEAR Account first"})},y="(xyiming)"===window.location.hostname?{accountSuffix:"near",networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:"dev-1630411495814-97749356114440",walletUrl:"https://wallet.near.org"}:{accountSuffix:"testnet",networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:"dev-1630685656410-62108694435619",walletUrl:"https://wallet.testnet.near.org"},k=function(e){Object(b.a)(n,e);var t=Object(j.a)(n);function n(e){var c;return Object(u.a)(this,n),(c=t.call(this,e))._near={},c.state={connected:!1,account:null},c._near.config=y,c._initNear().then((function(){c.setState({signedIn:!!c._near.accountId,signedAccountId:c._near.accountId,connected:!0})})),c}return Object(m.a)(n,[{key:"_initNear",value:function(){var e=Object(d.a)(i.a.mark((function e(){var t,n,c=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new p.keyStores.BrowserLocalStorageKeyStore,e.next=3,p.connect(Object.assign({deps:{keyStore:t}},y));case 3:n=e.sent,this._near.keyStore=t,this._near.near=n,this._near.walletConnection=new p.WalletConnection(n,y.contractName),this._near.accountId=this._near.walletConnection.getAccountId(),this._near.account=this._near.walletConnection.account(),this._near.contract=new p.Contract(this._near.account,y.contractName,{viewMethods:["get_account","get_stream"],changeMethods:["create_stream","deposit","withdraw","pause_stream","restart_stream","create_bridge","delete_bridge","push_flow","stop_stream"]}),this._near.logOut=function(){c._near.walletConnection.signOut(),c._near.accountId=null,c.setState({signedIn:!!c._accountId,signedAccountId:c._accountId})},this._near.refreshAllowance=Object(d.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("You're out of access key allowance. Need sign in again to refresh it"),e.next=3,c.logOut();case 3:return e.next=5,c.requestSignIn();case 5:case"end":return e.stop()}}),e)})));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"requestSignIn",value:function(){var e=Object(d.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.preventDefault(),"Streaming Xyiming",e.next=4,this._near.walletConnection.requestSignIn(y.contractName,"Streaming Xyiming");case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=Object(l.a)({_near:this._near,refreshAllowance:function(){return e._near.refreshAllowance()}},this.state),n=this.state.connected?this.state.signedIn?Object(f.jsx)("div",{children:Object(f.jsxs)("button",{className:"btn btn-outline-secondary",onClick:function(){return e._near.logOut()},children:["Sign out (",this.state.signedAccountId,")"]})}):Object(f.jsx)("div",{children:Object(f.jsx)("button",{className:"btn btn-primary",onClick:function(t){return e.requestSignIn(t)},children:"Sign in with NEAR Wallet"})}):Object(f.jsxs)("div",{children:["Connecting... ",Object(f.jsx)("span",{className:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"})]});return Object(f.jsx)("div",{className:"App text-white",style:{backgroundColor:"#1E1E1E"},children:Object(f.jsxs)(x.a,{basename:"",children:[Object(f.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark mb-3",style:{backgroundColor:"#2F2F2F"},children:Object(f.jsxs)("div",{className:"container-fluid",children:[Object(f.jsxs)(x.b,{className:"navbar-brand",to:"/",title:"Xyiming",children:[Object(f.jsx)("img",{src:h,alt:"Xyiming",className:"d-inline-block align-middle mx-3",style:{opacity:.65}}),"Streaming Xyiming"]}),Object(f.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(f.jsx)("span",{className:"navbar-toggler-icon"})}),Object(f.jsxs)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:[Object(f.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[Object(f.jsx)("li",{className:"nav-item",children:Object(f.jsx)(x.b,{className:"nav-link","aria-current":"page",to:"/",children:"Send"})}),Object(f.jsx)("li",{className:"nav-item",children:Object(f.jsx)(x.b,{className:"nav-link","aria-current":"page",to:"/receive",children:"Receive"})})]}),Object(f.jsx)("form",{className:"d-flex",children:n})]})]})}),Object(f.jsxs)(O.c,{children:[Object(f.jsx)(O.a,{exact:!0,path:"/",children:Object(f.jsx)(w,Object(l.a)({},t))}),Object(f.jsx)(O.a,{exact:!0,path:"/receive",children:Object(f.jsx)(_,Object(l.a)({},t))})]})]})})}}]),n}(a.a.Component);r.a.render(Object(f.jsx)(k,{}),document.getElementById("root"))}},[[187,1,2]]]);
//# sourceMappingURL=main.5fa9bb3e.chunk.js.map
(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{100:function(e,t,a){e.exports=a(187)},132:function(e,t,a){},135:function(e,t){},141:function(e,t){},157:function(e,t){},159:function(e,t){},177:function(e,t){},187:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(91),s=a.n(c),l=a(98),o=a(1),m=a.n(o),i=a(14),u=a(92),d=a(93),p=a(99),v=a(97),E=(a(58),a(121),a(131),a(132),a(30)),b=a(94),f=a.n(b),g=a(31),N=a(3),h=a(40),w=a(39),y=function(e){return parseFloat(e)/1e24||0};function _(){return r.a.createElement("div",{className:"d-flex justify-content-center",key:"1"},r.a.createElement("div",{className:"spinner-grow",role:"status"},r.a.createElement("span",{className:"visually-hidden"},"Loading...")))}var x=function(e){var t=e.signedAccountId,a=Object(n.useState)(!0),c=Object(h.a)(a,2),s=c[0],l=c[1];function o(){return(o=Object(i.a)(m.a.mark((function t(a,n){var r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),l(!1),console.log("stopping",n),t.next=5,e._near.contract.stop_stream({stream_id:n.stream_id},"200000000000000",1);case 5:r=t.sent,console.log("stopping res",r);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function u(){return(u=Object(i.a)(m.a.mark((function t(a){var n,r,c,s,o;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),l(!1),n=document.getElementById("ownerInput").value,r=document.getElementById("receiverInput").value,c=String(parseInt(1e9*(parseFloat(document.getElementById("depositInput").value)+.1)))+"000000000000000",s=String(parseInt(1e9*(parseFloat(document.getElementById("speedInput").value)+0)))+"000000",t.next=8,e._near.contract.create_stream({owner_id:n,receiver_id:r,token_name:"NEAR",tokens_per_tick:s},"200000000000000",c);case 8:o=t.sent,console.log("create res",o);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var d=function(){var a=Object(i.a)(m.a.mark((function a(){return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,t){a.next=3;break}return a.abrupt("return",[]);case 3:return a.next=5,e._near.contract.get_account({account_id:t});case 5:return a.abrupt("return",a.sent);case 8:a.prev=8,a.t0=a.catch(0),console.log("near error",a.t0);case 11:return a.abrupt("return",[]);case 12:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(){return a.apply(this,arguments)}}(),p=Object(w.a)(["account",t],d,{errorRetryInterval:250}).data,v=p&&p.outputs?p.outputs:[];return e.connected&&p&&(console.log("account",p),v=v.map((function(t,a){return r.a.createElement("div",{className:"card",style:{width:"90%",margin:"15px"},key:a},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"d-flex flex-row justify-content-between w-100"},r.a.createElement("div",{className:"col-2 m-1"},t.receiver_id),r.a.createElement("small",{className:"col-1 m-1"},r.a.createElement("small",null,r.a.createElement("samp",{className:"text-secondary"},t.stream_id.substr(0,6),"..."))),r.a.createElement("small",{className:"col-1 m-1"},y(t.balance).toFixed(2)),r.a.createElement("small",{className:"col-1 m-1"},t.token_name),r.a.createElement("small",{className:"col-1 m-1"},(1e9*y(t.tokens_per_tick)).toFixed(2)," ",t.token_name,"/s"),r.a.createElement("small",{className:"col-1 m-1"},y(t.tokens_available).toFixed(2)),r.a.createElement("small",{className:"col-1 m-1"},y(t.tokens_transferred).toFixed(2)),r.a.createElement("small",{className:"col-1 m-1"},t.status),r.a.createElement("div",{className:"col-2 m-1"},e.connected&&s&&"ACTIVE"===t.status?r.a.createElement("button",{disabled:!e.signedIn,className:"btn btn-danger",onClick:function(e){return function(e,t){return o.apply(this,arguments)}(e,t)}},"Stop the stream"):r.a.createElement("div",{className:"mt-4"},_())))))}))),console.log(e),e.connected?r.a.createElement("div",{className:"container g-0 px-5"},r.a.createElement("div",{className:"card",style:{width:"90%",margin:"15px"}},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},"Create a stream"),r.a.createElement("h6",{className:"card-subtitle mb-3 text-muted"},"Stream your tokens to the receiver directly"),r.a.createElement("form",{onSubmit:function(e){return function(e){return u.apply(this,arguments)}(e)}},r.a.createElement("div",{className:"form-group mb-2"},r.a.createElement("label",{htmlFor:"ownerInput",className:"mb-2"},"Owner"),r.a.createElement("input",{className:"form-control",id:"ownerInput",placeholder:e.signedAccountId})),r.a.createElement("div",{className:"form-group mb-2"},r.a.createElement("label",{htmlFor:"receiverInput",className:"mb-2"},"Receiver"),r.a.createElement("input",{className:"form-control",id:"receiverInput",placeholder:"root.near"})),r.a.createElement("label",{htmlFor:"depositInput",className:"mb-2"},"Initial deposit"),r.a.createElement("div",{className:"input-group mb-2"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text",id:"basic-addon1"},"\u24c3\u202f")),r.a.createElement("input",{className:"form-control",id:"depositInput",placeholder:"15.70",describedby:"basic-addon1"})),r.a.createElement("label",{htmlFor:"speedInput",className:"mb-2"},"Streaming speed, tokens per second"),r.a.createElement("div",{className:"input-group mb-2"},r.a.createElement("div",{className:"input-group-prepend"},r.a.createElement("span",{className:"input-group-text",id:"basic-addon2"},"\u24c3\u202f")),r.a.createElement("input",{className:"form-control",id:"speedInput",placeholder:"0.03",describedby:"basic-addon2"})),e.connected&&s?r.a.createElement("button",{disabled:!e.signedIn,className:"btn btn-primary mt-4"},"Create a stream"):r.a.createElement("div",{className:"mt-4"},_())))),r.a.createElement("h4",null,"Streams owned by you"),r.a.createElement("div",{className:"card",style:{width:"90%",margin:"15px"}},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"d-flex flex-row justify-content-between w-100"},r.a.createElement("div",{className:"col-2 m-1"},"Receiver"),r.a.createElement("div",{className:"col-1 m-1"},"Stream ID"),r.a.createElement("div",{className:"col-1 m-1"},"Total amount"),r.a.createElement("div",{className:"col-1 m-1"},"Token name"),r.a.createElement("div",{className:"col-1 m-1"},"Stream speed"),r.a.createElement("div",{className:"col-1 m-1"},"Tokens unlocked"),r.a.createElement("div",{className:"col-1 m-1"},"Tokens transferred"),r.a.createElement("div",{className:"col-1 m-1"},"Stream status"),r.a.createElement("div",{className:"col-2 m-1"})))),v):r.a.createElement("div",{className:"container g-0 px-5"},"Please connect your NEAR Account first")};var k=function(e){var t=e.signedAccountId,a=Object(n.useState)(!0),c=Object(h.a)(a,2),s=c[0],l=c[1];function o(){return(o=Object(i.a)(m.a.mark((function t(a,n){var r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),l(!1),console.log("withdraw",n),t.next=5,e._near.contract.withdraw({stream_id:n.stream_id},"200000000000000",0);case 5:r=t.sent,console.log("withdraw res",r),l(!0);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function u(){return(u=Object(i.a)(m.a.mark((function t(a,n){var r;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),l(!1),console.log("stopping",n),t.next=5,e._near.contract.stop_stream({stream_id:n.stream_id},"200000000000000",1);case 5:r=t.sent,console.log("stopping res",r);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var d=function(){var a=Object(i.a)(m.a.mark((function a(){return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,t){a.next=3;break}return a.abrupt("return",[]);case 3:return a.next=5,e._near.contract.get_account({account_id:t});case 5:return a.abrupt("return",a.sent);case 8:a.prev=8,a.t0=a.catch(0),console.log("near error",a.t0);case 11:return a.abrupt("return",[]);case 12:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(){return a.apply(this,arguments)}}(),p=Object(w.a)(["account",t],d,{errorRetryInterval:250}).data,v=p&&p.inputs?p.inputs:[];return e.connected&&p&&(console.log("account",p),v=v.map((function(t,a){return r.a.createElement("div",{className:"card",style:{width:"90%",margin:"15px"},key:a},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"d-flex flex-row justify-content-between w-100"},r.a.createElement("div",{className:"col-2 m-1"},t.owner_id),r.a.createElement("small",{className:"col-1 m-1"},r.a.createElement("small",null,r.a.createElement("samp",{className:"text-secondary"},t.stream_id.substr(0,6),"..."))),r.a.createElement("small",{className:"col-1 m-1"},y(t.balance).toFixed(2)),r.a.createElement("small",{className:"col-1 m-1"},t.token_name),r.a.createElement("small",{className:"col-1 m-1"},(1e9*y(t.tokens_per_tick)).toFixed(2)," ",t.token_name,"/s"),r.a.createElement("small",{className:"col-1 m-1"},y(t.tokens_available).toFixed(2)),r.a.createElement("small",{className:"col-1 m-1"},y(t.tokens_transferred).toFixed(2)),r.a.createElement("small",{className:"col-1 m-1"},t.status),r.a.createElement("div",{className:"col-2 m-1"},e.connected&&s&&"ACTIVE"===t.status?r.a.createElement("div",{className:"d-flex flex-row"},r.a.createElement("button",{disabled:!e.signedIn,className:"btn btn-success btn-sm m-1",onClick:function(e){return function(e,t){return o.apply(this,arguments)}(e,t)}},"Withdraw"),r.a.createElement("button",{disabled:!e.signedIn,className:"btn btn-danger btn-sm m-1",onClick:function(e){return function(e,t){return u.apply(this,arguments)}(e,t)}},"Stop")):r.a.createElement("div",{className:"mt-4"},_())))))}))),console.log(e),e.connected?r.a.createElement("div",{className:"container g-0 px-5"},r.a.createElement("h4",null,"Your receiving streams"),r.a.createElement("div",{className:"card",style:{width:"90%",margin:"15px"}},r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"d-flex flex-row justify-content-between w-100"},r.a.createElement("div",{className:"col-2 m-1"},"From owner"),r.a.createElement("div",{className:"col-1 m-1"},"Stream ID"),r.a.createElement("div",{className:"col-1 m-1"},"Tokens left"),r.a.createElement("div",{className:"col-1 m-1"},"Token name"),r.a.createElement("div",{className:"col-1 m-1"},"Stream speed"),r.a.createElement("div",{className:"col-1 m-1"},"Tokens unlocked"),r.a.createElement("div",{className:"col-1 m-1"},"Tokens transferred"),r.a.createElement("div",{className:"col-1 m-1"},"Stream status"),r.a.createElement("div",{className:"col-2 m-1"})))),v):r.a.createElement("div",{className:"container g-0 px-5"},"Please connect your NEAR Account first")},I="(xyiming)"===window.location.hostname?{accountSuffix:"near",networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:"dev-1630411495814-97749356114440",walletUrl:"https://wallet.near.org"}:{accountSuffix:"testnet",networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:"dev-1630411495814-97749356114440",walletUrl:"https://wallet.testnet.near.org"},S=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e))._near={},n.state={connected:!1,account:null},n._near.config=I,n._initNear().then((function(){n.setState({signedIn:!!n._near.accountId,signedAccountId:n._near.accountId,connected:!0})})),n}return Object(d.a)(a,[{key:"_initNear",value:function(){var e=Object(i.a)(m.a.mark((function e(){var t,a,n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new E.keyStores.BrowserLocalStorageKeyStore,e.next=3,E.connect(Object.assign({deps:{keyStore:t}},I));case 3:a=e.sent,this._near.keyStore=t,this._near.near=a,this._near.walletConnection=new E.WalletConnection(a,I.contractName),this._near.accountId=this._near.walletConnection.getAccountId(),this._near.account=this._near.walletConnection.account(),this._near.contract=new E.Contract(this._near.account,I.contractName,{viewMethods:["get_account","get_stream"],changeMethods:["create_stream","deposit","withdraw","stop_stream"]}),this._near.logOut=function(){n._near.walletConnection.signOut(),n._near.accountId=null,n.setState({signedIn:!!n._accountId,signedAccountId:n._accountId})},this._near.refreshAllowance=Object(i.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("You're out of access key allowance. Need sign in again to refresh it"),e.next=3,n.logOut();case 3:return e.next=5,n.requestSignIn();case 5:case"end":return e.stop()}}),e)})));case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"requestSignIn",value:function(){var e=Object(i.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.preventDefault(),"Streaming Xyiming",e.next=4,this._near.walletConnection.requestSignIn(I.contractName,"Streaming Xyiming");case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=Object(l.a)({_near:this._near,refreshAllowance:function(){return e._near.refreshAllowance()}},this.state),a=this.state.connected?this.state.signedIn?r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-outline-secondary",onClick:function(){return e._near.logOut()}},"Sign out (",this.state.signedAccountId,")")):r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-primary",onClick:function(t){return e.requestSignIn(t)}},"Sign in with NEAR Wallet")):r.a.createElement("div",null,"Connecting... ",r.a.createElement("span",{className:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"}));return r.a.createElement("div",{className:"App text-white",style:{backgroundColor:"#1E1E1E"}},r.a.createElement(g.a,{basename:""},r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark mb-3",style:{backgroundColor:"#2F2F2F"}},r.a.createElement("div",{className:"container-fluid"},r.a.createElement(g.b,{className:"navbar-brand",to:"/",title:"Xyiming"},r.a.createElement("img",{src:f.a,alt:"Xyiming",className:"d-inline-block align-middle",style:{opacity:.9,backgroundColor:"lightblue"}}),"Streaming Xyiming"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent"},r.a.createElement("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(g.b,{className:"nav-link","aria-current":"page",to:"/"},"Send")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(g.b,{className:"nav-link","aria-current":"page",to:"/receive"},"Receive"))),r.a.createElement("form",{className:"d-flex"},a)))),r.a.createElement(N.c,null,r.a.createElement(N.a,{exact:!0,path:"/"},r.a.createElement(x,t)),r.a.createElement(N.a,{exact:!0,path:"/receive"},r.a.createElement(k,t)))))}}]),a}(r.a.Component);s.a.render(r.a.createElement(S,null),document.getElementById("root"))},94:function(e,t,a){e.exports=a.p+"static/media/logo.e9cb853c.png"}},[[100,1,2]]]);
//# sourceMappingURL=main.c0d2e878.chunk.js.map
(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{128:function(e,t,n){},131:function(e,t,n){},136:function(e,t,n){},139:function(e,t){},145:function(e,t){},161:function(e,t){},163:function(e,t){},181:function(e,t){},187:function(e,t,n){},188:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(95),s=n.n(a),i=n(3),l=n(19),o=(n(62),n(117),n(127),n(128),n(6)),d=n(37),u=n(2),j=n.n(u),b=n(4),m=n(18),x=n(29),p=n(0),h=function(e){return parseFloat(e)/1e24||0},w=function(e){return parseFloat(e)/1e18||0};var f=n(17),O=n.n(f),v=(n(131),["icon","children","className","variant"]),g="main",N="outlined";function k(e){var t=e.icon,n=e.children,c=e.className,r=e.variant,a=void 0===r?"outlined":r,s=Object(l.a)(e,v),o="";return a===g?o="twind-px-12 twind-py-6 twind-font-bold Button--main twind-rounded-3xl":a===N&&(o="twind-border-solid twind-border twind-border-blue hover:twind-bg-blue twind-font-semibold twind-rounded-lg"),Object(p.jsxs)("button",Object(i.a)(Object(i.a)({className:O()("twind-inline-flex twind-items-center twind-justify-center twind-p-3  twind-whitespace-nowrap",o,"twind-transition-all",c)},s),{},{children:[t?Object(p.jsx)("div",{className:"twind-mr-2",children:t}):null,n]}))}var y=["icon","children","className","to"];function _(e){var t=e.icon,n=e.children,c=e.className,r=e.to,a=Object(l.a)(e,y),s=Object(o.g)(r),u=s&&s.isExact;return Object(p.jsxs)(d.b,Object(i.a)(Object(i.a)({to:r,className:O()(c,"twind-text-white twind-font-semibold","twind-flex twind-items-center twind-px-5 twind-py-4 twind-rounded-xl ","twind-group twind-cursor-pointer twind-whitespace-nowrap",u?"twind-bg-hover":"","twind-transition-all","hover:twind-bg-hover")},a),{},{children:[Object(p.jsx)("div",{className:O()("group-hover:twind-text-blue",u?"twind-text-blue":""),children:t}),Object(p.jsx)("div",{className:"twind-ml-2",children:n})]}))}n(136);var I=["children","error"];function S(e){var t=e.children,n=e.error,c=Object(l.a)(e,I),r=n?"twind-border-red-400":"twind-border-border";return Object(p.jsx)("label",Object(i.a)(Object(i.a)({className:O()("Input twind-font-semibold twind-flex twind-p-4 twind-rounded-lg twind-border  twind-bg-input twind-text-white focus-within:twind-border-blue hover:twind-border-blue",r)},c),{},{children:t}))}var C=["children","label","error","className"];function A(e){var t=e.children,n=e.label,c=e.error,r=e.className,a=Object(l.a)(e,C);return Object(p.jsxs)("label",Object(i.a)(Object(i.a)({className:O()("twind-block",r)},a),{},{children:[Object(p.jsx)("div",{className:"twind-mb-1",children:n}),Object(p.jsx)("div",{children:t}),c?Object(p.jsx)("div",{className:"twind-text-red-500 twind-mt-1 twind-text-xs",children:c}):null]}))}var E=n(30);function R(e){console.log("NearContractApi",e);var t=e.contract,n=function(){var e=Object(b.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n){e.next=3;break}return e.abrupt("return",[]);case 3:return e.next=5,t.get_account({account_id:n});case 5:return e.abrupt("return",e.sent);case 8:e.prev=8,e.t0=e.catch(0),console.log("near error",e.t0);case 11:return e.abrupt("return",[]);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return{getCurrentAccount:function(){return n(e.walletConnection.getAccountId())},getAccount:n}}var T="(xyiming)"===window.location.hostname?{accountSuffix:"near",networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:"dev-1630866505805-59948878430656",walletUrl:"https://wallet.near.org"}:{accountSuffix:"testnet",networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:"dev-1630866505805-59948878430656",walletUrl:"https://wallet.testnet.near.org",ft:"dev-1630798753809-34755859843881"},F=r.a.createContext({inited:!1,near:{keyStore:null,near:null,walletConnection:null,accountId:null,contract:null,ft:null},auth:{signedIn:!1,signedAccountId:null},contractApi:R({}),refreshAllowance:function(){},login:function(){},logout:function(){}});function B(){return L.apply(this,arguments)}function L(){return(L=Object(b.a)(j.a.mark((function e(){var t,n,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new E.keyStores.BrowserLocalStorageKeyStore,e.next=3,E.connect(Object.assign({deps:{keyStore:t}},T));case 3:return n=e.sent,(c={keyStore:null,near:null,walletConnection:null,accountId:null,contract:null,ft:null}).keyStore=t,c.near=n,c.walletConnection=new E.WalletConnection(n,T.contractName),c.accountId=c.walletConnection.getAccountId(),c.account=c.walletConnection.account(),c.contract=new E.Contract(c.account,T.contractName,{viewMethods:["get_account","get_stream"],changeMethods:["create_stream","deposit","withdraw","pause_stream","restart_stream","create_bridge","delete_bridge","push_flow","stop_stream"]}),c.ft=new E.Contract(c.account,T.ft,{viewMethods:["ft_balance_of"],changeMethods:["ft_transfer","ft_transfer_call"]}),e.abrupt("return",c);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var M=new Error("Near context is not found");function D(){var e=Object(c.useContext)(F);if(!!!e)throw M;return e}var H=function(){var e=D(),t=e.auth.signedAccountId,n=Object(c.useState)("NEAR"),r=Object(m.a)(n,2),a=r[0],s=r[1];function i(e,t){s(t)}function l(){return(l=Object(b.a)(j.a.mark((function t(n){var c,r,s,i,l;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),c=document.getElementById("ownerInput").value,r=document.getElementById("receiverInput").value,s="NEAR"===a?String(parseInt(1e9*(parseFloat(document.getElementById("depositInput").value)+.1)))+"000000000000000":"100000000000000000000000",i="NEAR"===a?String(parseInt(1e9*(parseFloat(document.getElementById("speedInput").value)+0)))+"000000":String(parseInt(1e9*(parseFloat(document.getElementById("speedInput").value)+0))),t.next=7,e.near.contract.create_stream({description:"blabla",owner_id:c,receiver_id:r,token_name:a,tokens_per_tick:i,auto_deposit_enabled:!1},"200000000000000",s);case 7:l=t.sent,console.log("create res",l);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var o=function(){var n=Object(b.a)(j.a.mark((function n(){return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,t){n.next=3;break}return n.abrupt("return",[]);case 3:return n.next=5,e.near.contract.get_account({account_id:t});case 5:return n.abrupt("return",n.sent);case 8:n.prev=8,n.t0=n.catch(0),console.log("near error",n.t0);case 11:return n.abrupt("return",[]);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}(),d=Object(x.a)(["account",t],o,{errorRetryInterval:250}).data,u=d&&d.outputs?d.outputs:[],h=u;return e.inited&&d&&(h=u.map((function(e,t){return Object(p.jsx)("option",{value:t,children:e.stream_id},t)}))),console.log("!!",h),Object(p.jsxs)("div",{className:"twind-container twind-m-auto twind-px-5 twind-py-12",children:[Object(p.jsxs)("div",{className:"twind-text-center",children:[Object(p.jsx)("h1",{className:"twind-text-5xl twind-mb-4 twind-text-center",children:"Create a stream"}),Object(p.jsx)("p",{className:"twind-text-gray",children:"Stream your tokens to the receiver directly"})]}),Object(p.jsxs)("form",{className:"twind-max-w-lg twind-mx-auto twind-w-full",onSubmit:function(e){return function(e){return l.apply(this,arguments)}(e)},children:[Object(p.jsx)(A,{label:"Owner:",className:"twind-mb-4",children:Object(p.jsx)(S,{children:Object(p.jsx)("input",{required:!0,placeholder:"owner.near",id:"ownerInput",value:e.near.accountId})})}),Object(p.jsx)(A,{label:"Receiver:",className:"twind-mb-4",children:Object(p.jsx)(S,{children:Object(p.jsx)("input",{required:!0,id:"receiverInput",placeholder:"root.near"})})}),Object(p.jsxs)(A,{label:"Token",className:"twind-mb-4",children:[Object(p.jsxs)("div",{className:"form-check mb-2",children:[Object(p.jsx)("input",{className:"form-check-input",type:"radio",name:"flexToken",id:"flexToken1",onClick:function(e){return i(0,"NEAR")},checked:"NEAR"===a}),Object(p.jsx)("label",{className:"form-check-label",htmlFor:"flexToken1",children:"NEAR tokens"})]}),Object(p.jsxs)("div",{className:"form-check mb-2",children:[Object(p.jsx)("input",{className:"form-check-input",type:"radio",name:"flexToken",id:"flexToken2",onClick:function(e){return i(0,"TARAS")},checked:"TARAS"===a}),Object(p.jsx)("label",{className:"form-check-label",htmlFor:"flexToken2",children:"TARAS Supremacy Tokens"})]})]}),"NEAR"===a?Object(p.jsx)(A,{label:"Initial deposit:",className:"twind-mb-4",children:Object(p.jsx)(S,{children:Object(p.jsx)("input",{requried:!0,placeholder:"0.00",id:"depositInput"})})}):null,Object(p.jsx)(A,{label:"Streaming speed, tokens per second",children:Object(p.jsx)(S,{children:Object(p.jsx)("input",{required:!0,id:"speedInput",placeholder:"0.03",describedby:"basic-addon2"})})}),Object(p.jsx)("div",{className:"twind-flex",children:Object(p.jsx)(k,{variant:"main",className:"twind-mt-12 twind-mx-auto",children:"Create Stream"})}),Object(p.jsx)("p",{className:"twind-text-center twind-text-gray twind-my-6",children:"You will be charged 0.006 ETH fee for that stream"})]})]})};var q=function(){var e=D(),t=e.auth.signedIn,n=e.near.accountId,r=Object(c.useState)(!0),a=Object(m.a)(r,2),s=a[0],i=a[1];function l(){return(l=Object(b.a)(j.a.mark((function t(n,c){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),i(!1),console.log("pausing",c),t.next=5,e.near.contract.pause_stream({stream_id:c.stream_id},"200000000000000",1);case 5:r=t.sent,console.log("pausing res",r);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function o(){return(o=Object(b.a)(j.a.mark((function t(n,c){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),i(!1),console.log("withdraw",c),t.next=5,e.near.contract.withdraw({stream_id:c.stream_id},"200000000000000",0);case 5:r=t.sent,console.log("withdraw res",r),i(!0);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function d(){return(d=Object(b.a)(j.a.mark((function t(n,c){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),i(!1),console.log("stopping",c),t.next=5,e.near.contract.stop_stream({stream_id:c.stream_id},"200000000000000",1);case 5:r=t.sent,console.log("stopping res",r);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var u=function(){var t=Object(b.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n){t.next=3;break}return t.abrupt("return",[]);case 3:return t.next=5,e.near.contract.get_account({account_id:n});case 5:return t.abrupt("return",t.sent);case 8:t.prev=8,t.t0=t.catch(0),console.log("near error",t.t0);case 11:return t.abrupt("return",[]);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}(),w=Object(x.a)(["account",n],u,{errorRetryInterval:250}).data,f=w&&w.inputs?w.inputs:[];return e.inited&&w&&(f=f.map((function(n,c){return Object(p.jsx)("div",{className:"card",style:{width:"90%",margin:"15px",backgroundColor:"#141414"},children:Object(p.jsx)("div",{className:"card-body",children:Object(p.jsxs)("div",{className:"d-flex flex-row justify-content-between w-100",children:[Object(p.jsx)("div",{className:"col-2 m-1",children:n.owner_id}),Object(p.jsx)("small",{className:"col-1 m-1",children:Object(p.jsx)("small",{children:Object(p.jsxs)("samp",{className:"text-secondary",children:[n.stream_id.substr(0,6),"..."]})})}),Object(p.jsx)("small",{className:"col-1 m-1",children:h(n.balance).toFixed(2)}),Object(p.jsx)("small",{className:"col-1 m-1",children:n.token_name}),Object(p.jsxs)("small",{className:"col-1 m-1",children:[(1e9*h(n.tokens_per_tick)).toFixed(2)," ",n.token_name,"/s"]}),Object(p.jsx)("small",{className:"col-1 m-1",children:h(n.tokens_available).toFixed(2)}),Object(p.jsx)("small",{className:"col-1 m-1",children:h(n.tokens_transferred).toFixed(2)}),Object(p.jsx)("small",{className:"col-1 m-1",children:n.status}),Object(p.jsx)("div",{className:"col-2 m-1",children:e.inited&&s&&"ACTIVE"===n.status?Object(p.jsxs)("div",{className:"d-flex flex-row",children:[Object(p.jsx)("button",{disabled:!t,className:"btn btn-success btn-sm m-1",onClick:function(e){return function(e,t){return o.apply(this,arguments)}(e,n)},children:"Withdraw"}),Object(p.jsx)("button",{disabled:!t,className:"btn btn-warning btn-sm m-1",onClick:function(e){return function(e,t){return l.apply(this,arguments)}(e,n)},children:"Pause"}),Object(p.jsx)("button",{disabled:!t,className:"btn btn-danger btn-sm m-1",onClick:function(e){return function(e,t){return d.apply(this,arguments)}(e,n)},children:"Stop"})]}):Object(p.jsx)("div",{})})]})})},c)}))),e.inited?Object(p.jsxs)("div",{className:"twcontainer g-0 px-5",children:[Object(p.jsx)("h4",{className:"twtext-2xl twmb-6",children:"Your receiving streams"}),Object(p.jsx)("div",{className:"card tww-full twbg-gray-700",children:Object(p.jsx)("div",{className:"card-body",children:Object(p.jsxs)("div",{className:"d-flex flex-row justify-content-between w-100",children:[Object(p.jsx)("div",{className:"col-2 m-1",children:"From owner"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Stream ID"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Tokens left"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Token name"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Stream speed"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Tokens unlocked"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Tokens transferred"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Stream status"}),Object(p.jsx)("div",{className:"col-2 m-1"})]})})}),f]}):Object(p.jsx)("div",{className:"container g-0 px-5",children:"Please connect your NEAR Account first"})};function z(){return Object(p.jsxs)("svg",{width:"31",height:"26",viewBox:"0 0 31 26",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(p.jsx)("path",{d:"M2.21044 3.01963C1.44551 1.68631 2.40806 0.0243835 3.94522 0.0243835H15.2557L28.301 22.7632C29.0659 24.0965 28.1033 25.7585 26.5662 25.7585H15.2557L2.21044 3.01963Z",fill:"white"}),Object(p.jsx)("path",{d:"M15.2556 25.7585H26.5661C28.1033 25.7585 29.0658 24.0965 28.3009 22.7632L22.6374 12.8914L15.2556 25.7585Z",fill:"#9692BB"}),Object(p.jsx)("path",{d:"M30.0193 0.0243835L15.2556 0.0243881L0.491936 25.7585L15.2556 25.7585L30.0193 0.0243835Z",fill:"white"})]})}var P=function(){return Object(p.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(p.jsx)("path",{d:"M1.99536 1.96368L10.5555 10.5238M10.5555 10.5238V1.96368M10.5555 10.5238H1.99542",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})})},U=function(){return Object(p.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(p.jsx)("path",{d:"M10.5309 10.5238L1.9707 1.96368M1.9707 1.96368V10.5238M1.9707 1.96368H10.5308",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round"})})},V=function(){return Object(p.jsxs)("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Object(p.jsx)("circle",{cx:"2.08925",cy:"2.03994",r:"2.03994",fill:"currentColor"}),Object(p.jsx)("circle",{cx:"11.1691",cy:"2.03994",r:"2.03994",fill:"currentColor"}),Object(p.jsx)("circle",{cx:"2.08925",cy:"11.1198",r:"2.03994",fill:"currentColor"}),Object(p.jsx)("circle",{cx:"11.1691",cy:"11.1198",r:"2.03994",fill:"currentColor"})]})};function W(e){var t=function(){var e=D();function t(){return(t=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n&&n.preventDefault(),t.next=3,e.login();case 3:return t.abrupt("return",!1);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function n(){return(n=Object(b.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.logout();case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return{accountId:e.auth.signedAccountId,signedIn:e.auth.signedIn,inited:e.inited,login:function(e){return t.apply(this,arguments)},logout:function(e){return n.apply(this,arguments)}}}(),n=t.inited,c=t.logout,r=t.login,a=t.accountId,s=t.signedIn;return n?s?Object(p.jsxs)(k,Object(i.a)(Object(i.a)({onClick:c},e),{},{children:["Sign out (",a,")"]})):Object(p.jsx)(k,Object(i.a)(Object(i.a)({onClick:r},e),{},{children:"Sign in with NEAR Wallet"})):Object(p.jsxs)(k,Object(i.a)(Object(i.a)({},e),{},{children:["Connecting..."," ",Object(p.jsx)("span",{className:"spinner-grow spinner-grow-sm",role:"status","aria-hidden":"true"})]}))}var Y="/my_streams",Z="/",J="/receive";function X(){var e=Object(p.jsxs)("ul",{className:"twind-flex-col lg:twind-flex-row twind-flex twind-justify-center ",children:[Object(p.jsx)("li",{className:"twind-mb-2 lg:twind-mr-2 lg:twind-mb-0",children:Object(p.jsx)(_,{to:Y,icon:Object(p.jsx)(V,{}),children:"My Streams"})}),Object(p.jsx)("li",{className:"twind-mb-2 lg:twind-mr-2 lg:twind-mb-0",children:Object(p.jsx)(_,{to:Z,icon:Object(p.jsx)(U,{}),children:"Send"})}),Object(p.jsx)("li",{children:Object(p.jsx)(_,{icon:Object(p.jsx)(P,{}),to:J,children:"Receive"})})]}),t=Object(p.jsxs)("div",{className:"twind-flex twind-justify-start twind-items-center",children:[Object(p.jsx)(z,{}),Object(p.jsx)("div",{className:"twind-px-1"}),Object(p.jsxs)("pre",{children:["Streaming ",Object(p.jsx)("br",{}),"Xyiming"]})]});return Object(p.jsxs)("div",{className:"twind-py-4 twind-px-6",children:[Object(p.jsxs)("div",{className:O()("twind-hidden lg:twind-grid twind-items-center twind-grid-cols-3 twind-gap-3 "),children:[t,e,Object(p.jsx)("div",{className:"twind-flex twind-justify-end",children:Object(p.jsx)(W,{})})]}),Object(p.jsxs)("div",{className:O()("lg:twind-hidden","navbar-dark"),children:[Object(p.jsxs)("div",{className:"twind-flex twind-justify-between",children:[t,Object(p.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(p.jsx)("span",{className:"navbar-toggler-icon"})})]}),Object(p.jsxs)("div",{className:"collapse navbar-collapse twind-mt-4",id:"navbarSupportedContent",children:[e,Object(p.jsx)(W,{className:"mt-4"})]})]})]})}function K(e){var t=e.output,n=function(e){var t=D(),n=r.a.useState(!1),c=Object(m.a)(n,2),a=c[0],s=c[1];function i(){return(i=Object(b.a)(j.a.mark((function n(c){var r;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("pausing",c),n.next=3,t.near.contract.pause_stream({stream_id:e},"200000000000000",1);case 3:return r=n.sent,console.log("pausing res",r),n.abrupt("return",r);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function l(){return(l=Object(b.a)(j.a.mark((function n(c){var r;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("restarting",c),n.next=3,t.near.contract.restart_stream({stream_id:e},"200000000000000",1);case 3:return r=n.sent,console.log("restarting res",r),n.abrupt("return",r);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function o(){return(o=Object(b.a)(j.a.mark((function n(c){var r;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("stopping",c),n.next=3,t.near.contract.stop_stream({stream_id:e},"200000000000000",1);case 3:return r=n.sent,console.log("stopping res",r),n.abrupt("return",r);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function d(e){return function(){if(!a){s(!0);try{return e.apply(void 0,arguments)}finally{s(!1)}}}}return{loading:a,pause:d((function(e){return i.apply(this,arguments)})),restart:d((function(e){return l.apply(this,arguments)})),stop:d((function(e){return o.apply(this,arguments)}))}}(t.stream_id);return n.loading?Object(p.jsx)("span",{children:"Loading!"}):"ACTIVE"===t.status||"PAUSED"===t.status?Object(p.jsxs)("div",{className:"d-flex flex-row",children:[Object(p.jsx)("div",{children:"ACTIVE"===t.status?Object(p.jsx)("button",{type:"button",className:"btn btn-warning btn-sm m-1",onClick:n.pause,children:"Pause"}):Object(p.jsx)("button",{type:"button",className:"btn btn-warning btn-sm m-1",onClick:n.restart,children:"Restart"})}),Object(p.jsx)("button",{type:"button",className:"btn btn-danger btn-sm m-1",onClick:n.stop,children:"Stop"})]}):Object(p.jsx)("div",{})}function G(){var e=D(),t=Object(c.useState)("NEAR"),n=Object(m.a)(t,2),r=n[0],a=n[1],s=Object(c.useState)(!0),i=Object(m.a)(s,2),l=i[0],o=i[1],d=Object(x.a)(["account",e.near.accountId],e.contractApi.getCurrentAccount,{errorRetryInterval:250}).data,u=d&&d.outputs?d.outputs:[],f=d?u.map((function(e,t){return Object(p.jsx)("option",{value:t,children:e.stream_id},t)})):[];function O(){return(O=Object(b.a)(j.a.mark((function t(n){var c,a,s,i,l,d;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),o(!1),!((c=document.getElementById("selectBox")).selectedIndex>0)){t.next=18;break}if(a=u[c.selectedIndex-1],"NEAR"!==r){t.next=13;break}return s=String(parseInt(1e9*parseFloat(document.getElementById("depositTokensInput").value)))+"000000000000000",t.next=9,e.near.contract.deposit({stream_id:a.stream_id},"200000000000000",s);case 9:i=t.sent,console.log("deposit NEAR res",i),t.next=18;break;case 13:return l=String(parseInt(1e9*parseFloat(document.getElementById("depositTokensInput").value)))+"000000000",t.next=16,e.near.ft.ft_transfer_call({receiver_id:e.near.near.config.contractName,amount:l,memo:"xyiming transfer",msg:a.stream_id},"200000000000000",1);case 16:d=t.sent,console.log("deposit TARAS res",d);case 18:o(!0);case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var v=u.map((function(e,t){return Object(p.jsx)("div",{className:"card",style:{width:"90%",margin:"15px",backgroundColor:"#141414"},children:Object(p.jsx)("div",{className:"card-body",children:Object(p.jsxs)("div",{className:"d-flex flex-row justify-content-between w-100",children:[Object(p.jsx)("div",{className:"col-2 m-1",children:e.receiver_id}),Object(p.jsx)("small",{className:"col-1 m-1",children:Object(p.jsx)("small",{children:Object(p.jsxs)("samp",{className:"text-secondary",children:[e.stream_id.substr(0,6),"..."]})})}),Object(p.jsx)("small",{className:"col-1 m-1",children:"NEAR"===e.token_name?h(e.balance).toFixed(2):w(e.balance).toFixed(2)}),Object(p.jsx)("small",{className:"col-1 m-1",children:e.token_name}),Object(p.jsxs)("small",{className:"col-1 m-1",children:["NEAR"===e.token_name?(1e9*h(e.tokens_per_tick)).toFixed(2):(1e9*w(e.tokens_per_tick)).toFixed(2)," ",e.token_name,"/s"]}),Object(p.jsx)("small",{className:"col-1 m-1",children:"NEAR"===e.token_name?h(e.tokens_available).toFixed(2):w(e.tokens_available).toFixed(2)}),Object(p.jsx)("small",{className:"col-1 m-1",children:"NEAR"===e.token_name?h(e.tokens_transferred).toFixed(2):w(e.tokens_transferred).toFixed(2)}),Object(p.jsx)("small",{className:"col-1 m-1",children:e.status}),Object(p.jsx)("div",{className:"col-2 m-1",children:Object(p.jsx)(K,{output:e})})]})})},t)}));return Object(p.jsxs)("div",{className:"twind-container",children:[Object(p.jsxs)("div",{children:[Object(p.jsx)("h4",{children:"Streams owned by you"}),Object(p.jsx)("div",{className:"card",style:{width:"90%",margin:"15px",backgroundColor:"#181818"},children:Object(p.jsx)("div",{className:"card-body",children:Object(p.jsxs)("div",{className:"d-flex flex-row justify-content-between w-100",children:[Object(p.jsx)("div",{className:"col-2 m-1",children:"Receiver"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Stream ID"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Tokens left"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Token name"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Stream speed"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Tokens unlocked"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Tokens transferred"}),Object(p.jsx)("div",{className:"col-1 m-1",children:"Stream status"}),Object(p.jsx)("div",{className:"col-2 m-1"})]})})}),v]}),Object(p.jsx)("div",{className:"card",style:{width:"90%",margin:"15px",backgroundColor:"#141414"},children:Object(p.jsxs)("div",{className:"card-body",children:[Object(p.jsx)("h5",{className:"card-title",children:"Deposit tokens"}),Object(p.jsx)("h6",{className:"card-subtitle mb-3 text-muted",children:"Extend your existing stream"}),Object(p.jsxs)("form",{onSubmit:function(e){return function(e){return O.apply(this,arguments)}(e)},children:[Object(p.jsxs)("div",{className:"form-group mb-2",children:[Object(p.jsx)("label",{htmlFor:"ownerInput",className:"mb-2",children:"Stream"}),Object(p.jsxs)("select",{id:"selectBox",className:"form-control custom-select",onChange:function(e){return function(e){var t=document.getElementById("selectBox");t.selectedIndex>0&&a(u[t.selectedIndex-1].token_name)}()},children:[Object(p.jsx)("option",{selected:!0,children:"Open this select menu"}),f]})]}),Object(p.jsx)("label",{htmlFor:"depositTokensInput",className:"mb-2",children:"Amount of tokens to deposit"}),Object(p.jsxs)("div",{className:"input-group mb-2",children:[Object(p.jsx)("div",{className:"input-group-prepend",children:Object(p.jsx)("span",{className:"input-group-text",id:"basic-addon2",style:{backgroundColor:"#303030",color:"#e0e0e0",fontSize:"150%"},children:"NEAR"===r?"\u24c3\u202f":"\ud83c\udd43"})}),Object(p.jsx)("input",{className:"form-control",id:"depositTokensInput",placeholder:"0.03",describedby:"basic-addon2",style:{backgroundColor:"#101010",color:"#e0e0e0"}})]}),e.inited&&l?Object(p.jsx)("button",{disabled:!e.auth.signedIn,className:"btn btn-primary mt-4",children:"Deposit"}):Object(p.jsx)("div",{className:"mt-4",children:Object(p.jsx)("div",{className:"d-flex justify-content-center",children:Object(p.jsx)("div",{className:"spinner-grow",role:"status",children:Object(p.jsx)("span",{className:"visually-hidden",children:"Loading..."})})},"1")})]})]})})]})}function Q(){D();return Object(p.jsxs)("div",{className:"twind-my-24 twind-text-center",children:[Object(p.jsxs)("h1",{className:"twind-text-3xl twind-mb-4 twind-font-semibold",children:[" ","Login via NEAR Network"," "]}),Object(p.jsx)("p",{className:"twind-text-gray",children:"Click button below to login or create new account"}),Object(p.jsx)(W,{className:"twind-mt-10"})]})}var $=["children","allowed","redirect"];function ee(e){var t=e.children,n=e.allowed,c=e.redirect,r=Object(l.a)(e,$);return Object(p.jsx)(o.b,Object(i.a)(Object(i.a)({},r),{},{render:function(e){e.location;return console.log("Render ".concat(r.path,", allowed? ").concat(n)),n?t:c}}))}var te=function(){var e=function(){var e=r.a.useRef(null),t=Object(c.useState)(!1),n=Object(m.a)(t,2),a=n[0],s=n[1],l=Object(c.useState)({keyStore:null,near:null,walletConnection:null,accountId:null,contract:null,ft:null}),o=Object(m.a)(l,2),d=o[0],u=o[1],x={signedIn:!!d.accountId,signedAccountId:d.accountId};function p(){return(p=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,d.walletConnection.requestSignIn(T.contractName,"Streaming Xyiming");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){d.walletConnection.signOut(),u(Object(i.a)(Object(i.a)({},d),{},{accountId:null}))}function w(){return(w=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return alert("You're out of access key allowance. Need sign in again to refresh it"),e.next=3,h();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){!function(){var t=Object(b.a)(j.a.mark((function t(){var n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B();case 2:n=t.sent,e.current=R(n),u(n),s(!0);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}),[]),{auth:x,near:d,contractApi:e.current,inited:a,login:function(){return p.apply(this,arguments)},logout:h,refreshAllowance:function(){return w.apply(this,arguments)}}}();return Object(p.jsx)(F.Provider,{value:e,children:Object(p.jsx)("div",{className:"twind-bg-dark text-white",children:e.inited?Object(p.jsxs)(d.a,{basename:"",children:[Object(p.jsx)(X,{}),Object(p.jsxs)(o.d,{children:[Object(p.jsx)(ee,{exact:!0,redirect:Object(p.jsx)(o.a,{to:"/"}),allowed:!e.auth.signedIn,path:"/authorize",children:Object(p.jsx)(Q,{})}),Object(p.jsx)(ee,{exact:!0,redirect:Object(p.jsx)(o.a,{to:"/authorize"}),allowed:e.auth.signedIn,path:"/",children:Object(p.jsx)(H,{})}),Object(p.jsx)(ee,{exact:!0,redirect:Object(p.jsx)(o.a,{to:"/authorize"}),allowed:e.auth.signedIn,path:"/my_streams",children:Object(p.jsx)(G,{})}),Object(p.jsx)(ee,{exact:!0,redirect:Object(p.jsx)(o.a,{to:"/authorize"}),allowed:e.auth.signedIn,path:"/receive",children:Object(p.jsx)(q,{})})]})]}):null})})};n(187);s.a.render(Object(p.jsx)(te,{}),document.getElementById("root"))}},[[188,1,2]]]);
//# sourceMappingURL=main.67daf8b1.chunk.js.map